# 실시간 공유 문서
이 프로젝트를 통해 로그인한 유저들끼리 실시간으로 문서를 작성, 수정, 저장까지 가능하게 할 수 있다.

### Authors
양선종

***

## 프로젝트 시작하기
### 프로젝트 시작 전 준비사항
이 프로젝트는 기본적으로 Node.Js, Mongodb를 다운로드 한 상태에서 시작합니다.
각각에 대한 링크는 아래를 참조해주시길 바랍니다.

Link: [NodeJs](https://nodejs.org/en/, "노드 홈페이지로")

Link: [MongoDb](https://nodejs.org/en/, "몽고디비 홈페이지로")


+ 패키지 다운로드
    + 실행 파일 이름 : Backend, Frontend
        ```
        $ npm install
        ```

+ .env 설정
    + 실행 파일 이름 : Backend, Frontend
        ```
        $ mkdir .env
        ```
    + 중요 env 설정 
        + Frontend : Firebase
            Link: [FireBase](https://firebase.google.com/, "firebae")
            ```
            firebase 관련 env같은 경우 참조한 링크를 참조하여 사용해 주 시길 바랍니다.
            // 예시 입니다.
            // React 를 사용하기 때문에 반드시 REACT_APP_... 의 형식으로 설정해주시길 바랍니다.
            REACT_APP_FIREBASE_API_KEY = "Your Own Secret Firebase API Key"
            ```
        + Backend : MongoDB_URI
            ```
            MONGODB_URI = 사용자의 아틀란스 서버를 입력해주세요
            ```

### 프로젝트 준비 완료 후 시작하기
+ 실행 파일 이름 : Frontend
    ```
    클라이언트 접속

    > http://localhost:3000/ 으로 접속
    $ npm start
    ```
+ 실행 파일 이름 : Backend
    ```
    서버접속

    $ npm start
    ```

*****

## 프로젝트 기능 설명 <각 페이지 별로>
### 로그인 페이지 : http://localhost:3000/login
#### ● 로그인 및 회원가입을 지원하는 페이지
![login] (https://user-images.githubusercontent.com/76609548/194014119-9b8ee0c6-fbf0-465c-94aa-b009938c5675.png")

이 페이지에서 지원하는 기능은 다음과 같습니다.
1. 로컬 로그인 : passport-local 전략 이용
> 사용자는 회원가입시 작성한 자신의 이메일 및 비밀번호를 입력하여 문서목록이 작성된 위치로 이동할 수 있습니다.
> 만약 회원가입된 정보와 다른 정보의 입력시 로그인이 되지 않습니다.
> 로그인 하지 않은 사람의 경우 회원가입 버튼을 클릭하여 회원가입을 진행할 수 있도록 구성되어있습니다.

2. 로컬 회원가입
> 사용자는 개인의 이메일, 비밀번호, 닉네임을 작성하여 로그인에 필요한 정보를 등록 할 수 있습니다.
> 기존에 입력한 이메일 정보로 가입된 유저가 있을 경우 회원가입되지 않습니다.
> 회원가입이 성공적으로 되면 "회원가입이 완료되었습니다." 메시지와 함께 다시 로그인 페이지로 넘어가 로그인을 진행 할 수 있습니다.
> 이미 회원가입이 된 유저의 경우 로그인하기 버튼을 누르면 로그인 정보를 입력할 수 있게 합니다.

3. 소셜(구글) 회원가입
> 페이지 내 존재하는 "G" 버튼을 통해 "Google 회원가입"이 가능합니다.
>> Google 회원가입의 경우 Firebase auth 를 통해 기능 구현을 하였습니다.
> 기존 Google로 회원가입을 한 사람이 존재하는 경우 회원가입되지 않습니다.
> 회원가입이 성공적으로 되면 "회원가입이 완료되었습니다." 메시지와 함께 다시 로그인 페이지로 넘어가 로그인을 진행 할 수 있습니다.

4. 소셜(구글) 로그인 : passport-local 전략 활용
> 페이지 내 존재하는 "G" 버튼을 통해 "Google 로그인"이 가능합니다. [ 따로 이메일, 비밀번호 입력을 하지 않아도 가능]
>> Google 로그인의 경우 Firebase auth 및 passport-local 전략을 활용해 기능 구현을 하였습니다.
> 등록된 정보가 없으면 로그인에 실패합니다.

5. 참고사항
> 소셜 or 로컬 회원가입시 모든 정보들은 해당하는 서버의 USERS 관련 데이터베이스에 저장이 됩니다. 
> 소셜 or 로컬 로그인을 선택하여 로그인시 로그인 한 유저들에게 JWT 토큰이 발급되며 토큰은 로컬 스토리지에 저장이 됩니다.
> 로그인을 하지 않은 유저의 경우 "/login" 페이지를 제외한 모든 페이지에 대한 이용이 불가능 합니다.

로그인에 성공시 메인 페이지로 넘어가게 됩니다.

### 메인 페이지  : http://localhost:3000/
#### ● 모든 문서의 정보들을 보여주는 페이지 입니다.

![main] (https://user-images.githubusercontent.com/76609548/194014503-d5fb01eb-1a71-4b87-a6de-801f5f336d75.png)

이 페이지에서 지원하는 기능은 다음과 같습니다.
1. 로그인한 사람에 대한 정보
> 로그인한 사람에 대한 정보가 반영되어 나타납니다.

2. 작성 진행중인 문서에 대한 정보
> 작성 진행중인 문서에 대한 제목과 그 문서를 누가 만든지에 대한 정보가 반영이 되어 나타닙니다.
> 그 문서들은 서버의 데이터베이스 내에서 Docs 모델에 대한 정보들을 가져옵니다.
> 해당 문서 작업하기를 누르게 되면 'http://localhost:3000/작업할 문서id' 링크로 넘어가게 됩니다.

3. 내가 작성한 작업 문서로 이동하기
> 로그인한 유저가 만든 작업 문서 페이지로 이동합니다.
> 'http://localhost:3000/own/로그인한 유저 id'

4. 새로운 문서 작성하기
>  새로운 문서를 작성할 수 있는 페이지로 이동합니다.
> 'http://localhost:3000/makeDocs'

5. 로그아웃
> 로그아웃 버튼을 클릭하게 되면 사용자의 JWT 토큰이 로컬 스토리지에서 제거 됨과 동시에 로그인 페이지로 다시 넘어가게 됩니다.

### 문서 생성 페이지 : http://localhost:3000/makeDocs
#### ● 문서를 작업하기 전 만드는 문서를 생성하는 페이지입니다

![make] (https://user-images.githubusercontent.com/76609548/194014712-c09503a0-55b3-42ac-a32c-7f7b3baccd8f.png)

1. 문서 생성
> 특정 문서를 작업하기 위해서 해야하는 기능이며 [제목] 란에 정보를 입력하여 "제출" 버튼을 클릭 할 경우 서버에 저장이 되어짐과 동시에 메인 페이지로 넘어갑니다.
> 메인페이지에서는 생성한 문서 정보가 반영이 되어 나타납니다.

2. 문서 목록으로 돌아가기 버튼
> 사용자들은 문서를 생성하지 않아도 문서 목록으로 돌아가기 버튼을 통해 메인 페이지로 넘어갈 수 있습니다.

### 개인 문서 목록 페이지 : http://localhost:3000/own/로그인한 유저 Id
#### ● 개인이 생성한 문서를 따로 보여주는 페이지입니다.

![myPage] (https://user-images.githubusercontent.com/76609548/194015019-0ffd939b-ff2e-4af7-a3c6-72ce7e03a31f.png)

1. 문서를 생성한 적이 없을 경우
> 문서를 생성한 적이 없을 경우에 어떠한 목록도 뜨지 않으며 , "만드신 문서가 존재하지 않습니다" 가 화면에 렌더링이 되어집니다
2. 문서를 생성한 적이 없을 경우
> 기본적으로 화면은 "메인 페이지"의 형식으로 구성되어집니다. 
> 다만 개인이 생성한 문서 목록만을 따로 보여줍니다. 타인이 생성한 문서 목록들은 문서 목록에서 제거 된 상태로 화면에 표시 되어집니다.

### 문서 작업 페이지 'http://localhost:3000/작업할 문서 Id'   
#### ● 실시간 문서가 작성되는 페이지입니다.

**핵심 페이지 입니다.**

![liveDocs] (https://user-images.githubusercontent.com/76609548/194015069-1837c471-8ce6-4def-af50-893a6071e430.png)

1. 문서 불러오기
> 사용자가 메인 페이지 혹은 개인 문서 목록 페이지를 통해 작성할 문서를 선택하여 들어오게 될 경우 해당 문서에 대한 정보가 서버의 docs 데이터 베이스 내에서 불러와 집니다.
> 해당 데이터 베이스에서 가져오는 정보는 크게 title, content 가 있으며 각각의 역활은 제목 및 문서의 내용에 해당 합니다.
> 제일 마지막으로 사용자에 의해 저장된 정보들이 반영되어 문서 제목 및 내용란에 저장이 됩니다.

2. 문서 작성
> 사용자들이 textarea란에 텍스트를 입력할 경우 그 텍스트가 실시간으로 공유가 됩니다.
>> 클라이언트가 달라도 한 클라이언트에서 텍스트를 입력할시 다른 클라언트에서도 그 입력된 정보가 반영되어집니다.
>> 이 기능은 socket을 활용하여 구현했습니다. 하단의 링크를 참조
>> Link: [Socket](https://socket.io/, "socket 홈페이지로")

3. 문서 저장 기능
    * 문서 저장 기능은 총 두개의 기능으로 구현되었습니다.
        * 문서 자동 저장
            > 문서 자동 저장 기능의 경우 문서 작성 페이지를 들어간 시점부터 "20"초가 지날 때 마다 현재의 정보들을 자동적으로 저장이 됩니다.
            >>  해당 기능은 useInterval 이라는 커스텀 훅을 사용하였습니다.
            > 저장된 정보는 서버의 docs 데이터베이스에 반영이 되어집니다.
        * 문서 수동 저장
            > 문서 수동 저장 기능의 경우 사용자는 문서 자동 저장 시간과 상관 없이 진행이 되어집니다.
            > 문서에 대한 텍스트를 저장하고 싶을 때 저장버튼을 누르게 되면 해당 텍스트가 바로 서버의 docs 데이터베이스 내에서 업데이트 됩니다.
            > 수동 저장 버튼을 누른다 하더라도 해당 작성 페이지에서 나가지지 않으며 계속 작성할 수 있도록 되었습니다.


*** 

## 요구사항
[x] -구글을 이용한 소셜 로그인이 되어야 합니다. (Firebase Auth 권장)
[x] -로그인한 사용자는 새로운 문서를 생성할 수 있습니다.
[x] -생성된 문서를 저장할 수 있는 기능이 있습니다.
[x] -저장된 문서는 고유한 URL이 부여됩니다.
[x] -문서 URL을 공유하여 다른 사용자들과 협업할 수 있습니다.
[x] -로그인하지 않은 사용자는 문서 URL에 접근할 수 없습니다.
[x] -로그인한 사용자는 문서 URL에 접근하여 문서 작업이 가능합니다.
[x] -문서 작업은 단순 텍스트 입력만 가능하며, 그 외에 텍스트의 스타일(굵기, 크기, 폰트)나 기
타 복잡한 문서작업 기능은 지원하지 않습니다.
[] -동시에 여러 사용자가 접속하여 동일한 문서에 작업하는 경우, 다른 동시 접속자들의 문서
작업 커서 위치가 사용자에게 표시되어야 합니다. (마우스 커서 위치가 아닌, 텍스트 타이핑 작
업을 하는 커서 위치입니다.)
[x] -저장된 문서는 매 20초마다 자동저장 되어야 하고, 다시 접속하여 작업할 경우 마지막으로 
저장된 작업 내용을 보여주어야 합니다.
[x] -로그인한 사용자는 본인이 생성한 문서 목록을 볼 수 있습니다.

*** 

### 개선해야할 점
1.
하다가 제일 개선해야 하다고 느낀 것은 토큰에 대한 저장 위치를 어떻게 신경써야 할까 이게 제일 큰 문제라고 생각이 든다.
일단 로컬 스토리지에 인증 토큰을 저장한 후에 그 암호화된 토큰을 해석하여 현재 로그인한 사람의 유저 정보를 가져오긴 했지만
프론트 엔드에서 이렇게 유저의 정보를 해석해서 가져오는 것이 옳은 행동인가에 대한 의문점이 강하게 들었다.


또한 로그인 기능을 구현하는 과정에 있어서 테스트의 하루를 거의 로그인에 썻을 만큼 로그인에 대한 구현이 매우 쉽지많은 않다라는 것을 다시한번 느끼게 되었다. 이번 로그인은 passport-local을 활용해서 소셜, 로컬 로그인을 구현하고 거기에 토큰을 발급해주는 상황으로 만들었지만 완전한 이해의 상태에서 토큰을 발급했다라고 보기에는 어려울 것 같다. 

추후 프로젝트에 있어서도 로그인에 대한 기능은 거의 필수적으로 나올 것 같은데 로그인을 어떻게 구현할 것인지를 신경을 더 써야 할 것 같다.

2. 잃어버린 React Redux
React Redux 사실 ... 어느 부분을 개선해야합니다! 라고 말을 할 수 없이 그냥 전부 다 개선해야할 것 같다라는 생각이 든다.
이번 테스트에서는 사실 Redux를 거의 쓰지 못한것도 사실이고 React를 사용함에 있어서도 테스트를 하면서 " 아 이거 어떻게 했더라" 라는 생각과 함께 여태까지 해온 과제들에서 어떻게 React를 썻었지 라는것을 참고하면서 기억하는 방향으로 사용을 한 것 같다.

사실 앞으로 REACT를 사용할 일이 많은데 이렇게 기억을 못하고 참고를 해서 쓰는 방향은 앞으로의 행보에 있어서도 좋지 못할게 분명하기 때문에
React에 대해서는 전반적으로 개선이 필요하다는 생각이 매우 많이 든다.